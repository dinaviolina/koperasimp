<x-layout>
    <div class="max-w-screen-xl mx-auto p-5 sm:p-10 md:p-16">
        <div class="border-b mb-5 flex justify-between text-sm">
            <div class="text-indigo-600 flex items-center pb-2 pr-2 border-b-2 border-indigo-600 uppercase">
                <svg class="h-6 mr-3" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 455.005 455.005"
                    style="enable-background:new 0 0 455.005 455.005;" xml:space="preserve">
                    <g>
                        <path
                            d="M446.158,267.615c-5.622-3.103-12.756-2.421-19.574,1.871l-125.947,79.309c-3.505,2.208-4.557,6.838-2.35,10.343 c2.208,3.505,6.838,4.557,10.343,2.35l125.947-79.309c2.66-1.675,4.116-1.552,4.331-1.432c0.218,0.12,1.096,1.285,1.096,4.428 c0,8.449-6.271,19.809-13.42,24.311l-122.099,76.885c-6.492,4.088-12.427,5.212-16.284,3.084c-3.856-2.129-6.067-7.75-6.067-15.423 c0-19.438,13.896-44.61,30.345-54.967l139.023-87.542c2.181-1.373,3.503-3.77,3.503-6.347s-1.323-4.974-3.503-6.347L184.368,50.615 c-2.442-1.538-5.551-1.538-7.993,0L35.66,139.223C15.664,151.815,0,180.188,0,203.818v4c0,23.63,15.664,52.004,35.66,64.595 l209.292,131.791c3.505,2.207,8.136,1.154,10.343-2.35c2.207-3.505,1.155-8.136-2.35-10.343L43.653,259.72 C28.121,249.941,15,226.172,15,207.818v-4c0-18.354,13.121-42.122,28.653-51.902l136.718-86.091l253.059,159.35l-128.944,81.196 c-20.945,13.189-37.352,42.909-37.352,67.661c0,13.495,4.907,23.636,13.818,28.555c3.579,1.976,7.526,2.956,11.709,2.956 c6.231,0,12.985-2.176,19.817-6.479l122.099-76.885c11.455-7.213,20.427-23.467,20.427-37.004 C455.004,277.119,451.78,270.719,446.158,267.615z">
                        </path>
                        <path
                            d="M353.664,232.676c2.492,0,4.928-1.241,6.354-3.504c2.207-3.505,1.155-8.136-2.35-10.343l-173.3-109.126 c-3.506-2.207-8.136-1.154-10.343,2.35c-2.207,3.505-1.155,8.136,2.35,10.343l173.3,109.126 C350.916,232.303,352.298,232.676,353.664,232.676z">
                        </path>
                        <path
                            d="M323.68,252.58c2.497,0,4.938-1.246,6.361-3.517c2.201-3.509,1.14-8.138-2.37-10.338L254.46,192.82 c-3.511-2.202-8.139-1.139-10.338,2.37c-2.201,3.51-1.14,8.138,2.37,10.338l73.211,45.905 C320.941,252.21,322.318,252.58,323.68,252.58z">
                        </path>
                        <path
                            d="M223.903,212.559c-3.513-2.194-8.14-1.124-10.334,2.39c-2.194,3.514-1.124,8.14,2.39,10.334l73.773,46.062 c1.236,0.771,2.608,1.139,3.965,1.139c2.501,0,4.947-1.251,6.369-3.529c2.194-3.514,1.124-8.14-2.39-10.334L223.903,212.559z">
                        </path>
                        <path
                            d="M145.209,129.33l-62.33,39.254c-2.187,1.377-3.511,3.783-3.503,6.368s1.345,4.983,3.54,6.348l74.335,46.219 c1.213,0.754,2.586,1.131,3.96,1.131c1.417,0,2.833-0.401,4.071-1.201l16.556-10.7c3.479-2.249,4.476-6.891,2.228-10.37 c-2.248-3.479-6.891-4.475-10.37-2.228l-12.562,8.119l-60.119-37.38l48.2-30.355l59.244,37.147l-6.907,4.464 c-3.479,2.249-4.476,6.891-2.228,10.37c2.249,3.479,6.894,4.476,10.37,2.228l16.8-10.859c2.153-1.392,3.446-3.787,3.429-6.351 c-0.018-2.563-1.344-4.94-3.516-6.302l-73.218-45.909C150.749,127.792,147.647,127.795,145.209,129.33z">
                        </path>
                        <path
                            d="M270.089,288.846c2.187-3.518,1.109-8.142-2.409-10.329l-74.337-46.221c-3.518-2.188-8.143-1.109-10.329,2.409 c-2.187,3.518-1.109,8.142,2.409,10.329l74.337,46.221c1.232,0.767,2.601,1.132,3.953,1.132 C266.219,292.387,268.669,291.131,270.089,288.846z">
                        </path>
                        <path
                            d="M53.527,192.864c-2.187,3.518-1.109,8.142,2.409,10.329l183.478,114.081c1.232,0.767,2.601,1.132,3.953,1.132 c2.506,0,4.956-1.256,6.376-3.541c2.187-3.518,1.109-8.142-2.409-10.329L63.856,190.455 C60.338,188.266,55.714,189.346,53.527,192.864z">
                        </path>
                    </g>
                </svg>
                <a href="#" class="font-semibold inline-block">{{ $title }}</a>
            </div>

        </div>
        <div class="container mx-auto px-4 py-8">
            <h1 class="text-3xl font-bold text-center mb-8"> {{ $nasabah->nama }}</h1>
            <p><span class="bold">Jumlah Simpanan saat ini: Rp</span>
                {{ number_format($nasabah->saldo, 0, ',', '.') }}</p>
            <!-- Search and Add User (Static) -->
            <div class="flex flex-row md:flex-row justify-end items-center gap-2 mb-6">
                {{-- <div class="w-full md:w-1/3 mb-4 md:mb-0">
                    <input type="text" placeholder="Search users..."
                        class="w-full px-4 py-2 rounded-md border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div> --}}
                <a href="{{ route('simpanan.create', $nasabah->kode_nasabah) }}" target="blank">
                    <button
                        class="bg-castletonGreen text-white  px-4 py-2 rounded-md hover:bg-darkGreen transition duration-300">
                        Tambah Simpanan
                    </button>
                </a>
                <a href="https://abhirajk.vercel.app/" target="blank"
                    class="inline-flex items-center justify-center w-1/2 px-3 py-2 text-sm font-medium text-center text-gray-900 bg-white border border-gray-300 rounded-md hover:bg-gray-100 focus:ring-4 focus:ring-primary-300 sm:w-auto dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-gray-700">
                    <svg class="w-5 h-5 mr-2 -ml-1" fill="currentColor" viewBox="0 0 20 20"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z"
                            clip-rule="evenodd"></path>
                    </svg>
                    Cetak PDF
                </a>
            </div>
            @if (session()->has('success'))
                <div class="bg-green-200 px-6 py-4 m-4 rounded-md text-lg flex w-full ml-0 mx-auto max-w-lg">
                    <svg viewBox="0 0 24 24" class="text-green-600 w-5 h-5 sm:w-5 sm:h-5 mr-3">
                        <path fill="currentColor"
                            d="M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z">
                        </path>
                    </svg>
                    <span class="text-green-800">{{ session('success') }}</span>

                </div>
            @endif
            <!-- User Table -->
            <div class="overflow-x-auto bg-white rounded-lg shadow">
                <table class="w-full table-auto">
                    <thead>
                        <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
                            <th class="py-3 px-6 text-left">No</th>
                            <th class="py-3 px-6 text-left">Tanggal Simpanan</th>
                            <th class="py-3 px-6 text-left">Bukti</th>
                            <th class="py-3 px-6 text-left">Jumlah</th>
                            <th class="py-3 px-6 text-left">Saldo</th>
                            <th class="py-3 px-6 text-center">Penarikan</th>
                            <th class="py-3 px-6 text-center">Status</th>
                            <th class="py-3 px-6 text-center">Aksi</th>
                        </tr>
                    </thead>
                    <tbody class="text-gray-600 text-sm">
                        @foreach ($simpanan as $s)
                            <tr class="border-b border-gray-200 hover:bg-gray-100">
                                <td class="py-3 px-6 text-left">{{ $loop->iteration }}</td>
                                <td class="py-3 px-6 text-left">{{ $s->created_at->format('d-m-Y H:i') }}</td>
                                <td class="py-3 px-6 text-left hover:underline">
                                    <img src="{{ asset('storage/' . $s->bukti_simpanan) }}" alt="bukti simpanan"
                                        class="cursor-pointer object-cover w-32 h-32"
                                        onclick="openModal('{{ asset('storage/' . $s->bukti_simpanan) }}')">
                                </td>
                                <td class="py-3 px-6 text-left">Rp
                                    {{ number_format($s->jumlah_simpanan, 0, ',', '.') }}</td>
                                <td class="py-3 px-6 text-left">Rp {{ number_format($s->nasabah->saldo, 0, ',', '.') }}
                                </td>
                                <td class="py-3 px-6 text-center"> Rp
                                    penarikan belum "-"
                                </td>
                                <td class="py-3 px-6 text-center">{{ ucfirst($s->status) }}</td>
                                <td class="py-3 px-6 text-center">
                                    @if ($s->status === 'disetujui')
                                        <div class="flex item-center justify-center">
                                            <a href="{{ route('nasabah.simpanan.cetak', $s->id) }}" target="_blank">
                                                <button onclick="downloadPDF()"
                                                    class="w-4 mr-2 transform hover:text-blue-500 hover:scale-110">
                                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none"
                                                        viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                                                        class="size-6">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            d="m9 13.5 3 3m0 0 3-3m-3 3v-6m1.06-4.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z" />
                                                    </svg>
                                                </button>
                                            </a>
                                        </div>
                                    @endif
                                </td>
                            </tr>
                        @endforeach
                    </tbody>
                </table>
            </div>
            <div>
                <a href="/">kembali</a>
            </div>

            <div class="flex justify-between items-center mt-6">
                <div>
                    <span class="text-sm text-gray-700">
                        Showing {{ $simpanan->firstItem() }} to {{ $simpanan->lastItem() }} of
                        {{ $simpanan->total() }} entries
                    </span>
                </div>
                <div class="flex space-x-2">
                    @if ($simpanan->onFirstPage())
                        <button class="px-3 py-1 rounded-md bg-gray-200 text-gray-700 opacity-50 cursor-not-allowed"
                            disabled>
                            Previous
                        </button>
                    @else
                        <a href="{{ $simpanan->previousPageUrl() }}">
                            <button class="px-3 py-1 rounded-md bg-gray-200 text-gray-700">
                                Previous
                            </button>
                        </a>
                    @endif
                    @if ($simpanan->hasMorePages())
                        <a href="{{ $simpanan->nextPageUrl() }}">
                            <button class="px-3 py-1 rounded-md bg-gray-200 text-gray-700">
                                Next
                            </button>
                        </a>
                    @else
                        <button class="px-3 py-1 rounded-md bg-gray-200 text-gray-700 opacity-50 cursor-not-allowed"
                            disabled>
                            Next
                        </button>
                    @endif
                </div>
            </div>

        </div>

    </div>
    <div id="imgModal" class="fixed inset-0 bg-black bg-opacity-70 hidden justify-center items-center z-50"
        onclick="closeModal()">
        <img id="modalImg" src="" class="max-h-full max-w-full rounded">
    </div>

    <script>
        function openModal(src) {
            document.getElementById('modalImg').src = src;
            document.getElementById('imgModal').classList.remove('hidden');
            document.getElementById('imgModal').classList.add('flex');
        }

        function closeModal() {
            document.getElementById('imgModal').classList.add('hidden');
            document.getElementById('imgModal').classList.remove('flex');
        }

        function downloadPDF() {
            const element = document.getElementById('kwitansi');
            html2pdf().from(element).save('kwitansi.pdf');
        }
    </script>

</x-layout>
